<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AeroPulse - Full Flight Form</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<style>
/* üåå Reset & base */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body,html{width:100%;height:100%;background:linear-gradient(135deg,#0b0c10,#1a1a2e);color:#fff;overflow:hidden;}

/* üñ§ Sidebar */
#sidebar{
  width:80px;height:100vh;
  background:rgba(18,18,25,0.65);
  backdrop-filter:blur(20px);
  display:flex;flex-direction:column;align-items:center;padding:20px 0;
  position:fixed;left:0;top:0;z-index:1000;
  border-right:1px solid rgba(255,255,255,0.05);
}
#sidebar .logo{font-size:20px;font-weight:700;color:#2ca1ff;margin-bottom:30px;}
.sidebar-btn{
  width:50px;height:50px;margin:12px 0;
  background:rgba(255,255,255,0.05);
  display:flex;justify-content:center;align-items:center;
  cursor:pointer;transition:all 0.25s;position:relative;
}
.sidebar-btn:hover,.sidebar-btn.active{background:rgba(44,161,255,0.2);transform:scale(1.15);}
.sidebar-btn svg{width:24px;height:24px;fill:#bbb;transition:fill 0.25s;}
.sidebar-btn:hover svg,.sidebar-btn.active svg{fill:#2ca1ff;}

/* üó∫Ô∏è Map */
#map{position:absolute;top:0;left:80px;right:0;bottom:0;z-index:0;}

/* üíß Pop-up glassy */
#formContainer{
  display:none;position:absolute;top:0;left:80px;width:calc(100% - 80px);height:100vh;
  background:rgba(18,18,28,0.65);backdrop-filter:blur(22px);
  padding:40px;overflow-y:auto;z-index:1000;
}
#formContainer.show{animation:popWaterIn 0.35s cubic-bezier(0.25,1,0.5,1) forwards;}
#formContainer.hide{animation:popWaterOut 0.35s cubic-bezier(0.25,1,0.5,1) forwards;}
@keyframes popWaterIn{0%{opacity:0;transform:scale(0.8);}60%{opacity:1;transform:scale(1.05);}100%{transform:scale(1);}}
@keyframes popWaterOut{0%{opacity:1;transform:scale(1);}100%{opacity:0;transform:scale(0.8);}}

/* ‚úàÔ∏è Flight Form */
#flightForm{
  max-width:520px;margin:0 auto;
  background:rgba(30,30,40,0.7);
  padding:30px 40px;border-radius:4px;
  box-shadow:0 12px 30px rgba(0,0,0,0.5);backdrop-filter:blur(18px);
}
#flightForm h2{text-align:center;color:#2ca1ff;font-weight:600;font-size:20px;margin-bottom:20px;}
#flightForm label{display:block;color:#ccc;margin-top:12px;font-size:14px;}
#flightForm input,#flightForm select{
  width:100%;padding:10px 12px;border:1px solid rgba(255,255,255,0.2);
  background:rgba(20,22,28,0.5);color:#fff;margin-top:6px;font-size:14px;
  transition:all 0.25s;
}
#flightForm input:focus,#flightForm select:focus{border-color:#2ca1ff;box-shadow:0 0 10px rgba(44,161,255,0.3);outline:none;}
#flightForm button{
  width:100%;padding:12px;margin-top:20px;border:none;background:#2ca1ff;color:#fff;font-size:15px;font-weight:600;cursor:pointer;
  transition:0.25s, transform 0.2s;
}
#flightForm button:hover{background:#1b8de0;transform:translateY(-2px);}

/* üé´ Ticket */
#ticket{
  margin-top:20px;background:rgba(20,22,28,0.8);
  padding:20px;color:#fff;border-left:4px solid #2ca1ff;
  display:none;font-size:14px;
}

/* üåÄ Scrollbar */
#formContainer::-webkit-scrollbar{width:10px;}
#formContainer::-webkit-scrollbar-thumb{background:rgba(100,100,100,0.4);}
#formContainer::-webkit-scrollbar-thumb:hover{background:rgba(180,180,180,0.5);}
</style>
</head>

<body>

<div id="sidebar">
  <div class="logo">Aero</div>
  <div class="sidebar-btn" id="homeBtn"><svg viewBox="0 0 24 24"><path d="M3 11L12 2l9 9v11a1 1 0 0 1-1 1h-6v-6h-4v6H4a1 1 0 0 1-1-1V11z"/></svg></div>
  <div class="sidebar-btn" id="newFlightBtn"><svg viewBox="0 0 24 24"><path d="M2.5 19.5l19-7-19-7v4l14 3-14 3v4z"/></svg></div>
  <div class="sidebar-btn" id="trafficBtn"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="#fff" stroke-width="2" fill="none"/><path d="M12 2a10 10 0 0 1 0 20"/></svg></div>
</div>

<div id="map"></div>

<div id="formContainer">
<form id="flightForm">
  <h2>New Flight Plan</h2>
  <label>Departure Airport</label>
  <input type="text" id="departure" placeholder="e.g. JFK" required>
  <label>Arrival Airport</label>
  <input type="text" id="arrival" placeholder="e.g. LAX" required>
  <label>Callsign</label>
  <input type="text" id="callsign" placeholder="Flight number" required>
  <label>Select Aircraft</label>
  <select id="aircraft">
    <option value="A320">Airbus A320</option>
    <option value="B737">Boeing 737</option>
    <option value="B777">Boeing 777</option>
    <option value="A380">Airbus A380</option>
    <option value="A350">Airbus A350</option>
    <option value="B787">Boeing 787 Dreamliner</option>
    <option value="A321">Airbus A321</option>
    <option value="A330">Airbus A330</option>
    <option value="A340">Airbus A340</option>
    <option value="B747">Boeing 747</option>
    <option value="E190">Embraer E190</option>
    <option value="CRJ700">CRJ700</option>
    <option value="MD11">MD-11</option>
  </select>
  <button type="submit">Load Flight</button>
  <div id="ticket"></div>
</form>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// ===== Map =====
const map = L.map('map',{minZoom:3,maxZoom:15,zoomControl:true}).setView([20,0],2);
L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',{
  attribution:'&copy; OpenStreetMap, CARTO', subdomains:'abcd', maxZoom:19
}).addTo(map);

// Airports (gi·ªØ nguy√™n danh s√°ch c·ªßa b·∫°n)
const airports = { "ATL": [33.6407, -84.4277],
  "DFW": [32.8998, -97.0403],
  "DEN": [39.8561, -104.6737],
  "ORD": [41.9742, -87.9073],
  "LAX": [33.9416, -118.4085],
  "CLT": [35.2144, -80.9431],
  "MIA": [25.7959, -80.2871],
  "SEA": [47.4474, -122.3088],
  "PHX": [33.4343, -112.0084],
  "JFK": [40.6413, -73.7781],
  "LHR": [51.4700, -0.4543],
  "CDG": [49.0097, 2.5479],
  "AMS": [52.3086, 4.7639],
  "FRA": [50.0379, 8.5622],
  "IST": [41.2618, 28.7360],
  "MAD": [40.4839, -3.5679],
  "BCN": [41.2974, 2.0787],
  "MUC": [48.3537, 11.7861],
  "FCO": [41.8003, 12.2389],
  "LGW": [51.1537, -0.1821],
  "DXB": [25.2532, 55.3657],
  "HND": [35.5494, 139.7798],
  "ICN": [37.4602, 126.4407],
  "SIN": [1.3592, 103.9892],
  "PVG": [31.1434, 121.8055],
  "PEK": [40.0799, 116.6031],
  "CAN": [23.3924, 113.3088],
  "KUL": [2.7433, 101.6961],
  "BKK": [13.6899, 100.7501],
  "DEL": [28.5665, 77.1000],
  "SFO": [37.6213, -122.3790],
  "BOS": [42.3643, -71.0052],
  "FLL": [26.0726, -80.1527],
  "EWR": [40.6925, -74.1687],
  "IAD": [38.9531, -77.4565],
  "ORL": [28.5670, -81.3140],
  "YYZ": [43.6777, -79.6248],
  "YVR": [49.1939, -123.1843],
  "MEX": [19.4363, -99.0721],
  "CUN": [21.0366, -86.8770],
  "DUB": [53.4264, -6.2499],
  "ZRH": [47.4516, 8.5646],
  "VIE": [48.1103, 16.5697],
  "OSL": [60.1939, 11.1004],
  "ARN": [59.6519, 17.9186],
  "CPH": [55.6179, 12.6559],
  "WAW": [52.1658, 20.9671],
  "PRG": [50.1008, 14.2965],
  "BUD": [47.4300, 19.2550],
  "ATH": [37.9364, 23.9450],
  "JED": [21.6798, 39.1557],
  "RUH": [24.9575, 46.6877],
  "DOH": [25.2731, 51.6083],
  "AUH": [24.4330, 54.6511],
  "BOM": [19.0911, 72.8596],
  "MAA": [12.9866, 80.1833],
  "HKG": [22.3080, 113.9184],
  "TPE": [25.0777, 121.2328],
  "NRT": [35.7647, 140.3863],
  "KIX": [34.4272, 135.2443],
  "SYD": [-33.9461, 151.1772],
  "MEL": [-37.6733, 144.8433],
  "AKL": [-37.0082, 174.7917],
  "GIG": [-22.8105, -43.2505],
  "GRU": [-23.4356, -46.4731],
  "SCL": [-33.3930, -70.7858],
  "BUE": [-34.8222, -58.5358],
  "LIM": [-12.0219, -77.1147],
  "LPA": [27.9329, -15.3861],
  "PMI": [39.5517, 2.7675],
  "ADB": [38.2925, 27.1569],
  "SAW": [40.8983, 29.3092],
  "CAI": [30.1219, 31.4056],
  "CPT": [-33.9685, 18.6017],
  "JNB": [-26.1392, 28.2460],
  "NBO": [-1.3193, 36.9274],
  "ADD": [8.9806, 38.7997],
  "LOS": [6.5770, 3.3216],
  "BLR": [13.1986, 77.7066],
  "HYD": [17.2359, 78.4292],
  "MNL": [14.5078, 121.0189],
  "SGN": [10.8189, 106.6994],
  "HAN": [21.2211, 105.8080],
  "CGK": [-6.1257, 106.6559],
  "PUS": [35.1794, 128.9375],
  "TXL": [52.5597, 13.2877],
  "BRU": [50.9014, 4.4844],
  "GVA": [46.2381, 6.1089],
  "LIS": [38.7758, -9.1353],
  "MAN": [53.3536, -2.2749],
  "DUS": [51.2895, 6.7667],
  "HAM": [53.6300, 9.9880],
  "STR": [48.6899, 9.2219],
  "AGP": [36.6749, -4.4990],
  "VCE": [45.5053, 12.3519],
  "GOA": [44.4133, 8.8475],
  "OTP": [44.5707, 26.1023],
  "SOF": [42.6953, 23.4072],
  "TLV": [32.0093, 34.8778],
  "AMM": [31.7994, 35.9904],
  "BEY": [33.8209, 35.4883],
  "ESB": [40.1194, 32.9995],
  "TAS": [41.2619, 69.2721],
  "ALA": [43.3540, 77.0267], /* S·ª≠a l·ªói c√∫ ph√°p */
  "IAH": [29.9844, -95.3414],
  "DTW": [42.3670, -83.3533],
  "MSP": [44.8819, -93.2217],
  "PHL": [39.8744, -75.2424],
  "SAN": [32.7338, -117.1897],
  "TPA": [27.9734, -82.5345],
  "RSW": [26.5323, -81.7552],
  "PDX": [45.5877, -122.5951],
  "SLC": [40.7899, -111.9791],
  "HNL": [21.3187, -157.9224],
  "DCA": [38.8510, -77.0400],
  "MDW": [41.7859, -87.7524],
  "DAL": [32.8471, -96.8524],
  "OAK": [37.7213, -122.2202],
  "ONT": [34.0560, -117.6015],
  "CCU": [22.6545, 88.4467],
  "SZX": [22.6393, 113.8122],
  "CKG": [29.7184, 106.6320],
  "XMN": [24.5381, 118.1340],
  "CTU": [30.5785, 103.9470],
  "WUH": [30.7760, 114.2053],
  "TNA": [36.8596, 117.0700],
  "TSN": [39.1170, 117.3468],
  "SHE": [41.6377, 123.4838],
  "DLC": [38.9656, 121.5510],
  "HGH": [30.2289, 120.4344],
  "NKG": [31.7423, 118.8767],
  "MLE": [4.1910, 73.5350],
  "CMB": [7.1265, 79.8850],
  "DPS": [-8.7477, 115.1670],
  "SUB": [-7.3775, 112.7869],
  "ADL": [-34.9450, 138.5340],
  "PER": [-31.9403, 115.9676],
  "BNE": [-27.3840, 153.1175],
  "CHC": [-43.4833, 172.5333],
  "WLG": [-41.3269, 174.8058],
  "NCL": [55.0359, -1.6917],
  "EDI": [55.9500, -3.3725],
  "GLA": [55.8719, -4.4331],
  "BRS": [51.3833, -2.7167],
  "BHX": [52.4539, -1.7489],
  "HEL": [60.3187, 24.9497],
  "GND": [12.0042, -61.7850],
  "SNN": [52.7011, -8.8920],
  "BFS": [54.6575, -6.2167],
  "NCE": [43.6652, 7.2150],
  "MRS": [43.9213, 5.2155],
  "LYS": [45.7265, 5.0815],
  "TLS": [43.6333, 1.3630],
  "NTE": [47.1539, -1.6105],
  "CGN": [50.8784, 7.1222],
  "HAJ": [52.4600, 9.6850],
  "LEJ": [51.4233, 12.2366],
  "SXF": [52.3789, 13.5255],
  "KWI": [29.2274, 47.9610],
  "BAH": [26.2708, 50.6338],
  "MCT": [23.5934, 58.2811],
  "ACC": [5.6053, -0.1666],
  "DKR": [14.7303, -17.4527],
  "RAK": [31.6063, -8.0363],
  "CCS": [10.6010, -66.9930],
  "BOG": [4.7016, -74.1471],
  "PTY": [9.0653, -79.3837],
  "SJO": [9.9972, -84.2045],
  "SDQ": [18.4286, -69.6687],
  "HAV": [22.9882, -82.3855],
  "BWI": [39.1774, -76.6684],
  "AUS": [30.1975, -97.6663],
  "SAT": [29.5338, -98.4697],
  "IND": [39.7180, -86.2941],
  "CMH": [40.0031, -82.8872],
  "RDU": [35.8776, -78.7885],
  "STL": [38.7487, -90.3665],
  "TUS": [32.1161, -110.9410],
  "SMF": [38.6879, -121.5229],
  "BUR": [34.2001, -118.3587],
  "LGB": [33.8175, -118.1517],
  "PVD": [41.7397, -71.4326],
  "ROC": [43.1189, -77.6726],
  "BUF": [42.9406, -78.7327],
  "PIT": [40.4851, -80.2366],
  "MKE": [42.9472, -87.8966],
  "CVG": [39.0488, -84.6672],
  "CLE": [41.4116, -81.8497],
  "MCO": [28.4294, -81.3089],
  "TUL": [36.1983, -95.8887],
  "OKC": [35.3986, -97.6003],
  "MEM": [35.0424, -89.9766],
  "GSO": [36.0970, -79.9392],
  "RIC": [37.5052, -77.3197],
  "PBI": [26.6832, -80.0955],
  "SRQ": [27.3957, -82.5559],
  "ABQ": [35.0402, -106.6091],
  "ELP": [31.8079, -106.3764],
  "LAS": [36.0840, -115.1537],
  "FAT": [36.7761, -119.7181],
  "MDT": [40.1983, -76.7644],
  "CAK": [40.9168, -81.4421],
  "PSP": [33.8297, -116.5065],
  "SAV": [32.1276, -81.2012],
  "CHS": [32.8986, -80.0400],
  "LEX": [38.0371, -84.6059],
  "TYS": [35.8159, -83.9922],
  "GRR": [42.8808, -85.5221],
  "OMA": [41.3005, -96.0245],
  "YWG": [49.9079, -97.2390],
  "YHZ": [44.8808, -63.5133],
  "YUL": [45.4706, -73.7408],
  "YYC": [51.1219, -114.0075],
  "GCM": [19.2906, -81.3582],
  "NAS": [25.0397, -77.4000],
  "AUA": [12.5014, -70.0152],
  "CUR": [12.1883, -68.9592],
  "SJU": [18.4394, -66.0018],
  "KIN": [17.9356, -76.7869],
  "MBJ": [18.5020, -77.9133],
  "PUJ": [18.5630, -68.3634],
  "MDE": [6.1645, -75.4116],
  "CLO": [3.5350, -76.3813],
  "GYE": [-2.1554, -79.8872],
  "UIO": [-0.1444, -78.4870],
  "LPB": [-16.5132, -68.1764],
  "ASU": [-25.2635, -57.5146],
  "MVD": [-34.8385, -56.0307],
  "SSA": [-12.9150, -38.3303],
  "REC": [-8.1265, -34.9229],
  "BSB": [-15.8677, -47.9213],
  "POA": [-29.9939, -51.1714],
  "EZE": [-34.8222, -58.5358],
  "VCP": [-23.0089, -47.1344],
  "MAO": [-3.0373, -60.0505],
  "FOR": [-3.7766, -38.5325],
  "VNO": [54.6433, 25.2825],
  "RIX": [56.9234, 23.9749],
  "TLL": [59.4133, 24.8328],
  "KRK": [50.0777, 19.8058],
  "GDN": [54.3776, 18.4662],
  "WRO": [51.1022, 16.8831],
  "POZ": [52.4211, 16.9261],
  "BTS": [48.1702, 17.1852],
  "KOS": [50.8828, 20.9142],
  "LUX": [49.6266, 6.2045],
  "SXB": [48.5383, 7.6294],
  "BSL": [47.5997, 7.5290],
  "NUE": [49.4986, 11.0667],
  "BRE": [53.0475, 8.7866],
  "BLQ": [44.5352, 11.2882],
  "PSA": [43.6833, 10.3920],
  "CTA": [37.4667, 15.0667],
  "PMO": [38.1759, 13.0910],
  "NAP": [40.8845, 14.2886],
  "LIN": [45.4452, 9.2764],
  "HFE": [31.8410, 117.2790],
  "TAO": [36.2667, 120.3667],
  "WUX": [31.5649, 120.4280],
  "FOC": [26.0827, 119.2974],
  "SWA": [23.4208, 116.3264],
  "HAK": [19.9686, 110.1347],
  "NNG": [22.6167, 108.2033],
  "KMG": [25.0061, 102.7441],
  "URC": [43.9079, 87.4741],
  "LHW": [36.2307, 103.6200],
  "XIY": [34.4449, 108.7528],
  "CJU": [33.4079, 126.4921],
  "GMP": [37.5583, 126.7917],
  "FUK": [33.5858, 130.4431],
  "ITM": [34.7865, 135.4382],
  "NGO": [34.8580, 136.8166],
  "OKA": [26.1958, 127.6531],
  "KHH": [22.5694, 120.3547],
  "DAD": [16.0544, 108.2022],
  "CXR": [11.9967, 109.2197],
  "PQC": [10.2222, 103.9572],
  "KTM": [27.6974, 85.3567],
  "DAC": [23.8433, 90.3978] 
                 };
let flightLayer = null;

// Sidebar interactions
const formContainer=document.getElementById('formContainer');
document.getElementById('newFlightBtn').addEventListener('click',()=>{formContainer.classList.remove('hide');formContainer.classList.add('show');formContainer.style.display='block';});
document.getElementById('homeBtn').addEventListener('click',()=>{formContainer.classList.remove('show');formContainer.classList.add('hide');setTimeout(()=>formContainer.style.display='none',350);});
document.getElementById('trafficBtn').addEventListener('click',()=>{formContainer.classList.remove('show');formContainer.classList.add('hide');setTimeout(()=>formContainer.style.display='none',350);});

// Flight form submit
document.getElementById('flightForm').addEventListener('submit', e=>{
  e.preventDefault();
  const dep = document.getElementById('departure').value.toUpperCase();
  const arr = document.getElementById('arrival').value.toUpperCase();
  const callsign = document.getElementById('callsign').value.toUpperCase();
  const aircraft = document.getElementById('aircraft').options[document.getElementById('aircraft').selectedIndex].text;

  if(!airports[dep] || !airports[arr]) { alert("Airport not found!"); return; }
  const depPos = airports[dep], arrPos = airports[arr];

  if(flightLayer) map.removeLayer(flightLayer);

  // Great circle line
  function generateGreatCircle(start, end, steps=100){
    const coords=[];
    const [lat1, lon1] = start.map(d=>d*Math.PI/180);
    const [lat2, lon2] = end.map(d=>d*Math.PI/180);
    const d = 2*Math.asin(Math.sqrt(Math.sin((lat2-lat1)/2)**2 + Math.cos(lat1)*Math.cos(lat2)*Math.sin((lon2-lon1)/2)**2));
    for(let i=0;i<=steps;i++){
      const f=i/steps;
      const A=Math.sin((1-f)*d)/Math.sin(d), B=Math.sin(f*d)/Math.sin(d);
      const x = A*Math.cos(lat1)*Math.cos(lon1)+B*Math.cos(lat2)*Math.cos(lon2);
      const y = A*Math.cos(lat1)*Math.sin(lon1)+B*Math.cos(lat2)*Math.sin(lon2);
      const z = A*Math.sin(lat1)+B*Math.sin(lat2);
      const lat = Math.atan2(z, Math.sqrt(x*x+y*y));
      const lon = Math.atan2(y,x);
      coords.push([lat*180/Math.PI, lon*180/Math.PI]);
    }
    return coords;
  }

  const routeCoords = generateGreatCircle(depPos, arrPos, 100);
  flightLayer = L.polyline(routeCoords,{color:'cyan',weight:3,opacity:0.7}).addTo(map);

  map.fitBounds(flightLayer.getBounds(),{padding:[50,50]});

  // Flight marker animation
  const flightMarker = L.marker(depPos).addTo(map);
  let idx=0;
  function moveMarker(){
    if(idx<routeCoords.length){
      flightMarker.setLatLng(routeCoords[idx]);
      idx++; setTimeout(moveMarker,50);
    }
  }
  moveMarker();

  // Show ticket
  const ticket = document.getElementById('ticket');
  ticket.style.display='block';
  ticket.innerHTML = `<b>Flight:</b> ${callsign}<br><b>Aircraft:</b> ${aircraft}<br><b>From:</b> ${dep}<br><b>To:</b> ${arr}`;
});
</script>

</body>
</html>
